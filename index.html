<!doctype html>
<html lang="nb">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Snake ‚Äì Gloser uke 45 (Kampen 6. trinn)</title>
<style>
body{margin:0;font-family:system-ui;background:#0b1020;color:#eef3fb;text-align:center;overflow:hidden}
canvas{background:#0a1020;border:1px solid #1b274b;border-radius:10px;width:95vw;max-width:720px;height:auto;margin-top:10px}
button{background:#1b274b;color:white;border:1px solid #2a3a68;border-radius:10px;padding:8px 12px;font-size:16px;margin:4px;cursor:pointer}
button:active{transform:scale(.96)}.btn-on{background:#215c41}
#mob{margin-top:10px}#mob button{width:60px;height:60px;font-size:24px}
#modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center}
#card{background:#101833;padding:20px;border-radius:12px;width:90%;max-width:420px}
#ans{width:100%;padding:10px;font-size:18px;border-radius:8px;border:1px solid #2a3a68;background:#0b1020;color:white}
#hint{display:none;margin-top:8px;color:#9fb1d1}
table{border-collapse:collapse;width:90%;margin:10px auto;color:#eef3fb}
th,td{border:1px solid #2a3a68;padding:6px 8px}th{background:#1a2240}
</style>
</head>
<body>
<h2>Snake ‚Äì Gloser uke 45</h2>
<canvas id="game" width="720" height="480"></canvas><br>
<button id="start">Start</button>
<button id="pause">Pause</button>
<button id="beginner">Nybegynner: AV</button><br>
Poeng: <span id="score">0</span>‚ÄÉLiv: <span id="lives">‚ù§‚ù§‚ù§</span>‚ÄÉTopp: <span id="best">0</span>
<div id="mob">
  <div><button id="up">‚¨ÜÔ∏è</button></div>
  <div><button id="left">‚¨ÖÔ∏è</button><button id="down">‚¨áÔ∏è</button><button id="right">‚û°Ô∏è</button></div>
</div>
<br>
<button id="toggleFasit">Vis fasit ‚ñº</button>
<div id="fasit" style="display:none"></div>

<div id="modal">
 <div id="card">
   <p>Skriv engelsk for: <b id="norw"></b></p>
   <input id="ans" type="text" autocomplete="off">
   <div id="hint"></div>
   <br>
   <button id="check">Sjekk</button>
   <button id="showHint">Vis fasit</button>
   <button id="skip">Hopp over</button>
 </div>
</div>

<script>
const WORDS=[
{en:"Decent",no:"ordentlig"},{en:"Grin",no:"smil"},{en:"Terrified",no:"veldig redd"},
{en:"Wailed",no:"gr√•t"},{en:"Yelping",no:"bjeffende"},{en:"Leer",no:"sultent blikk"},
{en:"Furry coat",no:"pelsk√•pe"},{en:"Flickers",no:"blunker i rykninger"},
{en:"Whips out",no:"trekker frem"},{en:"Knickers",no:"underbukser"}];

const c=document.getElementById("game"),ctx=c.getContext("2d");
let grid=24,cols=c.width/grid,rows=c.height/grid;
let snake,dir,nextDir,apple,score,lives,paused=true,loopId=null,speed=7;
let current,usedHint=false,beginner=false;
const LS="snake45_best";
document.getElementById("best").textContent=localStorage.getItem(LS)||0;

function rand(n){return Math.floor(Math.random()*n);}
function reset(){
 snake=[{x:10,y:10}];dir={x:1,y:0};nextDir={x:1,y:0};
 apple={x:rand(cols),y:rand(rows)};score=0;lives=3;
 document.getElementById("score").textContent=score;
 document.getElementById("lives").textContent="‚ù§‚ù§‚ù§";
 paused=false;cancelAnimationFrame(loopId);loopId=requestAnimationFrame(tick);
}
function draw(){
 ctx.fillStyle="#0a1020";ctx.fillRect(0,0,c.width,c.height);
 ctx.fillStyle="#79c8ff";
 snake.forEach(s=>ctx.fillRect(s.x*grid+2,s.y*grid+2,grid-4,grid-4));
 ctx.fillText("üçé",apple.x*grid+grid/2,apple.y*grid+grid/2);
}
function tick(){
 if(paused)return loopId=requestAnimationFrame(tick);
 const head={...snake[0]};head.x+=nextDir.x;head.y+=nextDir.y;
 if(head.x<0)head.x=cols-1;if(head.x>=cols)head.x=0;
 if(head.y<0)head.y=rows-1;if(head.y>=rows)head.y=0;
 if(snake.some(s=>s.x==head.x&&s.y==head.y)){lose();return;}
 snake.unshift(head);
 if(head.x==apple.x&&head.y==apple.y){paused=true;ask();}
 else snake.pop();
 draw();setTimeout(()=>loopId=requestAnimationFrame(tick),1000/speed);
}
function lose(){lives--;document.getElementById("lives").textContent="‚ù§".repeat(lives);
 if(lives<=0){paused=true;const b=+localStorage.getItem(LS)||0;if(score>b)localStorage.setItem(LS,score);
 alert("Game over! Poeng: "+score);}snake=[{x:10,y:10}];}
function ask(){
 current=WORDS[rand(WORDS.length)];usedHint=false;
 document.getElementById("norw").textContent=current.no;
 document.getElementById("ans").value="";document.getElementById("hint").style.display="none";
 document.getElementById("modal").style.display="flex";
 document.getElementById("showHint").style.display=beginner?"none":"inline-block";
 if(beginner){document.getElementById("hint").style.display="block";
 document.getElementById("hint").textContent="Fasit: "+current.en;}
}
function check(){
 let val=document.getElementById("ans").value.trim().toLowerCase();
 let ok=val===current.en.toLowerCase();
 document.getElementById("modal").style.display="none";
 if(ok)score+=beginner?5:(usedHint?5:10);else if(!beginner)lose();
 document.getElementById("score").textContent=score;
 apple={x:rand(cols),y:rand(rows)};paused=false;
}
function lose(){lives--;document.getElementById("lives").textContent="‚ù§".repeat(lives);
 if(lives<=0){paused=true;const b=+localStorage.getItem(LS)||0;if(score>b)localStorage.setItem(LS,score);
 alert("Game over! Poeng: "+score);}snake=[{x:10,y:10}];}
document.getElementById("check").onclick=check;
document.getElementById("skip").onclick=()=>{document.getElementById("modal").style.display="none";paused=false;};
document.getElementById("showHint").onclick=()=>{usedHint=true;
 document.getElementById("hint").style.display="block";document.getElementById("hint").textContent="Fasit: "+current.en;};

function setDir(dx,dy){if(dx==-dir.x&&dy==-dir.y)return;nextDir={x:dx,y:dy};}
document.addEventListener("keydown",e=>{
 if(e.key=="ArrowUp")setDir(0,-1);
 if(e.key=="ArrowDown")setDir(0,1);
 if(e.key=="ArrowLeft")setDir(-1,0);
 if(e.key=="ArrowRight")setDir(1,0);
});
["up","down","left","right"].forEach(id=>{
 document.getElementById(id).onclick=()=>{if(id=="up")setDir(0,-1);
 if(id=="down")setDir(0,1);if(id=="left")setDir(-1,0);if(id=="right")setDir(1,0);}
});

document.getElementById("start").onclick=()=>reset();
document.getElementById("pause").onclick=()=>paused=!paused;
document.getElementById("beginner").onclick=()=>{
 beginner=!beginner;
 document.getElementById("beginner").textContent="Nybegynner: "+(beginner?"P√Ö":"AV");
 document.getElementById("beginner").classList.toggle("btn-on",beginner);
};

/* Fasit under spillet */
document.getElementById("toggleFasit").onclick=()=>{
 let f=document.getElementById("fasit");
 if(f.style.display=="none"){f.style.display="block";
 f.innerHTML="<table><tr><th>Engelsk</th><th>Norsk</th></tr>"+
 WORDS.map(w=>`<tr><td>${w.en}</td><td>${w.no}</td></tr>`).join("")+"</table>";
 document.getElementById("toggleFasit").textContent="Skjul fasit ‚ñ≤";}
 else{f.style.display="none";document.getElementById("toggleFasit").textContent="Vis fasit ‚ñº";}
};

draw();
</script>
</body>
</html>
